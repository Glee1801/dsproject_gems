---
title: "Data Science Project"
author: "Gaocha Lee, Elizabeth Cain, Maya Fernandez, and Stephanie Konadu-Acheampong "
date: "3/5/2021"
output: 
  html_document:
    keep_md: TRUE
    toc: TRUE
    toc_float: TRUE
    df_print: paged
    code_download: true
---


```{r setup, include=FALSE}
# knitr::opts_chunk$set(echo = TRUE, message = TRUE, warning = TRUE)
```


```{r libraries}
library(readr)
library(tidyverse)
library(lubridate)
library(maps)          
library(ggmap)
library(RColorBrewer)  # for color palettes
library(sf)            # for working with spatial data
library(leaflet)       # for highly customizable mapping
library(ggthemes)      # for more themes (including theme_map())
library(plotly)        # for the ggplotly() - basic interactivity
library(gganimate)     # for adding animation layers to ggplots
library(transformr)
library(ggimage)
theme_set(theme_minimal())
```

```{r}
dataset <- read_csv("Data.csv")
View(dataset)
```


```{r}


newdataest<- dataset %>% 
  group_by(Age) %>% 
  mutate(avgsleep = mean(Sleep))%>%
  ggplot(aes(x = Age, y = avgsleep)) +
  geom_col() +
  # facet_wrap(vars(Age)) +
  labs(title = "Connection With Loved Ones", 
       subtitle = "Students Who Find Themselves More Connected with Family, Close Friends, and Relatives")

newdataest

```

```{r}

newdataest %>%
  group_by(Age, Connection) %>%
  summarise(avgclasstime = mean(OnlineClass)) %>%
  ggplot(aes(x = Age,
             y = avgclasstime, 
             color = Connection)) +
  geom_jitter() +
  # facet_wrap(vars(Connection))+
  labs(x = "Age", 
       y = "", 
       title = "Average Amount of Hours Spent in Class by Age")


```


```{r}

newdataest$AgeCat = cut(newdataest$Age, c(0,13,18,23,33,45,60))
#how to change names for each of the categories?

newdataest %>%
  group_by(AgeCat, Connection) %>%
  # summarise(avgclasstime = mean(OnlineClass)) %>%
  ggplot(aes(x = AgeCat,
             y = OnlineClass, 
             fill = Connection)) +
  geom_boxplot() +
  facet_wrap(vars(Connection))+
  labs(x = "Age", 
       y = "", 
       title = "Average Amount of Hours Spent in Class by Age")


```


```{r}
newdataest$AgeCat = cut(newdataest$Age, c(0,13,18,23,33,45,60))
#how to change names for each of the categories?

newdataset<- newdataest %>%
  # mutate(str_sub())
  group_by(AgeCat, Connection, Region) %>%
  # summarise(avgclasstime = mean(OnlineClass)) %>%
  ggplot(aes(x = AgeCat,
             y = OnlineClass, 
             fill = Connection)) +
  geom_boxplot() +
  facet_wrap(vars(Region))+
  labs(x = "Age", 
       y = "", 
       title = "Average Amount of Hours Spent in Class by Age")
newdataset 

```


```{r}

###preferred graph 

newdataest$AgeCat = cut(newdataest$Age, c(0,13,18,23,33,45,60))
#how to change names for each of the categories?

newdataset<- newdataest %>%
  # mutate(str_sub())
  group_by(AgeCat, Connection, Region) %>%
  # summarise(avgclasstime = mean(OnlineClass)) %>%
  ggplot(aes(x = AgeCat,
             y = OnlineClass, 
             fill = Connection)) +
  geom_boxplot() +
  facet_wrap(vars(Connection))+
  labs(x = "Age", 
       y = "", 
       title = "Average Amount of Hours Spent in Class by Age")
newdataset 
```


