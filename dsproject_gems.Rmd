---
title: "Data Science Project"
author: "Gaocha Lee, Elizabeth Cain, Maya Fernandez, and Stephanie Konadu-Acheampong "
date: "3/5/2021"
output: 
  html_document:
    keep_md: TRUE
    toc: TRUE
    toc_float: TRUE
    df_print: paged
    code_download: true
    code_folding: hide
---


```{r setup, include=FALSE}
# knitr::opts_chunk$set(echo = TRUE, message = TRUE, warning = TRUE)
```


```{r libraries}
library(readr)
library(tidyverse)
library(lubridate)
library(maps)          
library(ggmap)
library(RColorBrewer)  # for color palettes
library(sf)            # for working with spatial data
library(leaflet)       # for highly customizable mapping
library(ggthemes)      # for more themes (including theme_map())
library(plotly)        # for the ggplotly() - basic interactivity
library(gganimate)     # for adding animation layers to ggplots
library(transformr)
library(ggimage)
theme_set(theme_minimal())
```

```{r}

dataset <- read_csv("Data.csv") %>% 
  mutate(AgeCat = cut(Age, breaks = c(0,13,18,23,33,45,60), labels = c("0-13", "13-18", "18-23", "23-33", "33-45", "45-60"))) %>%
  mutate(avgsleep = mean(Sleep)) %>% 
  mutate(SocialCat = cut_number(SocialMedia, n = 3))
  
#labels = "0-1", "1-3", "3-10" label social media 

View(dataset)

```

Add paragraph here talking about the dataset background and background to covid-19. 

```{r}
#demographics
dataset %>% 
  ggplot(aes(x = Age)) +
  geom_bar(fill = "steelblue1") +
  scale_x_continuous(name = "", breaks = c(5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60)) +
  labs(title = "Number of Survey Respondents by Age", x = "Age", y = "")

```

We noticed that most of the survey respondents were young, etc. From research paper: the total number of respondents was ___. 

```{r}
#demographics
dataset %>% 
  ggplot(aes(x = Region)) +
  geom_bar(fill = "steelblue1") +
  labs(title = "Number of Survey Respondents by Region", x = "", y = "")
```

Observations about this plot. Describe NCR (National Capital Region), because Delhi is the Capital of India. The city is the center and the NCR is slightly larger than the urban area itself. 


```{r}
#not from test file
dataset %>% 
  ggplot(aes(x = Age, y = Sleep)) +
  geom_jitter() +
  # facet_wrap(vars(Age)) +
  labs(title = "Age and Sleep")
```



```{r}
#in project file 
#preferred graph 

dataset %>%
  group_by(AgeCat, Connection, Region) %>% 
  ggplot(aes(x = AgeCat,
             y = OnlineClass)) +
  geom_boxplot() +
  labs(x = "Age", 
       y = "", 
       title = "Comparing Hours Spent in Class Per Day by Age") +
  theme(axis.line = element_blank(), 
        panel.grid = element_blank(), 
        plot.title.position= "plot", 
        strip.text.x = element_blank())

```




```{r}
dataset %>% 
  ggplot(aes(x = SocialCat, 
             y = Sleep, 
             color = AgeCat)) +
  geom_boxplot() +
  # facet_wrap(vars(AgeCat)) +
  labs(y = "", 
       x = "", 
       title = "Average Amount of Sleep and Media Use in Hours by Age Category") +
  theme(axis.line = element_blank(), 
        panel.grid = element_blank(), 
        plot.title.position= "plot", 
        legend.position = "none")+
  scale_color_viridis_d()
  
```


```{r}
#scatterplot 

dataset %>% 
  group_by(SocialMedia, avgsleep, AgeCat, Sleep) %>%
  summarise(avgmedia = mean(SocialMedia)) %>%
  ggplot(aes(x = avgmedia, 
             y = avgsleep, 
             color = AgeCat)) +
  geom_jitter() +
  facet_wrap(vars(AgeCat)) +
  labs(y = "", 
       x = "Average Hours of Media Use", 
       title = "Average Amount of Sleep and Media Use in Hours by Age Category") +
  theme(axis.line = element_blank(), 
        panel.grid = element_blank(), 
        plot.title.position= "plot", 
        legend.position = "none")+
  scale_color_viridis_d()
```


